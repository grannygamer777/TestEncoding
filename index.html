<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Emoji Compression Test</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    textarea { width: 100%; height: 80px; }
    .output { border: 1px solid #ccc; padding: 10px; margin-top: 10px; white-space: pre-wrap; }
  </style>
</head>
<body>
<h2>Emoji Dictionary Compressor</h2>

<p>Enter numbers (comma separated):</p>
<textarea id="input">0,0,400,400,300,300,200,200,100,100,321,124,222</textarea>
<br>
<button onclick="doEncode()">Encode</button>
<button onclick="doDecode()">Decode</button>

<h3>Compressed:</h3>
<div id="compressed" class="output"></div>
<h3>Decoded:</h3>
<div id="decoded" class="output"></div>

<script>
const EMOJIS = [..."😀😃😄😁😆😅🤣😂🙂🙃😉😊😇🥰😍🤩😘😗☺️😚😙🥲😋😛😜🤪😝🤑🤗🤭🤫🤔🤐🤨😐😑😶😶‍🌫️🙄😏😒😞😔😟😕🙁☹️😣😖😫😩🥺😢😭😤😠😡🤬🤯😳🥵🥶😱😨😰😥😓🤗🫡🫢🫣🫠"]; 
// can extend with full set if needed

function encodeList(nums) {
  // count frequency
  let freq = {};
  nums.forEach(n => freq[n] = (freq[n] || 0) + 1);

  // choose most frequent (>=3 occurrences)
  let frequent = Object.entries(freq).filter(([n,c]) => c >= 3);
  frequent.sort((a,b) => b[1] - a[1]);

  let dict = {};
  for (let i=0; i<frequent.length && i<EMOJIS.length; i++) {
    dict[frequent[i][0]] = EMOJIS[i];
  }

  // build dictionary string
  let dictStr = Object.entries(dict).map(([num,emoji]) => emoji + "=" + num).join(",") + ";";

  // replace numbers with emoji if possible
  let out = nums.map(n => dict[n] || n).join("");

  return dictStr + out;
}

function decodeList(str) {
  if (!str.includes(";")) return [];

  let [dictPart, body] = str.split(";",2);

  // parse dictionary
  let dict = {};
  if (dictPart.trim() !== "") {
    dictPart.split(",").forEach(entry => {
      if (entry.includes("=")) {
        let [emoji, num] = entry.split("=");
        dict[emoji] = num;
      }
    });
  }

  // decode body: replace emojis with their numbers
  let decoded = "";
  for (let ch of body) {
    decoded += dict[ch] !== undefined ? dict[ch] + "," : ch;
  }

  // handle plain numbers left
  let nums = decoded.split(/,|\s+/).filter(x => x.length>0).map(Number);
  return nums;
}

function doEncode() {
  let nums = document.getElementById("input").value.split(",").map(x => parseInt(x.trim())).filter(x=>!isNaN(x));
  let code = encodeList(nums);
  document.getElementById("compressed").innerText = code;
}

function doDecode() {
  let code = document.getElementById("compressed").innerText;
  let decoded = decodeList(code);
  document.getElementById("decoded").innerText = decoded.join(",");
}
</script>
</body>
</html>
