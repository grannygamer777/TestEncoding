<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Custom Compression</title>
</head>
<body>
<h3>Custom List Compressor</h3>
<textarea id="input" rows="3" cols="60">0,0,400,400,300,300,200,200,100,100,321,124,222</textarea><br>
<button onclick="doEncode()">Encode</button>
<button onclick="doDecode()">Decode</button>
<p><b>Compressed:</b> <span id="compressed"></span></p>
<p><b>Decoded:</b> <span id="decoded"></span></p>

<script>
// ---- encode a single number (0–2375) to "0a–99z" ----
function encodeSymbol(num) {
  if (num < 10) return num.toString();
  num -= 10;
  let prefix = Math.floor(num / 26);
  let letter = String.fromCharCode(97 + (num % 26));
  return prefix.toString() + letter;
}

// ---- decode back from "0a–99z" ----
function decodeSymbol(sym) {
  if (/^\d$/.test(sym)) return parseInt(sym);
  let prefix = parseInt(sym.slice(0, -1));
  let letter = sym.slice(-1);
  return 10 + prefix * 26 + (letter.charCodeAt(0) - 97);
}

// ---- ENCODE LIST ----
function encodeList(nums) {
  // Pack the list into one big integer
  let value = 0n;
  for (let n of nums) {
    value = value * 401n + BigInt(n); // base-401 packing
  }
  // Convert that big integer into a single symbol index
  // (mod the range 0–2375 for demo purposes)
  let compressedIndex = Number(value % 2376n);
  let compressedSym = encodeSymbol(compressedIndex);

  // encode length separately
  let lengthSym = encodeSymbol(nums.length);

  return compressedSym + "-" + lengthSym;
}

// ---- DECODE LIST ----
function decodeList(code, base=401) {
  let [sym, lenSym] = code.split("-");
  let length = decodeSymbol(lenSym);

  let index = decodeSymbol(sym);

  // ⚠️ NOTE: because we modded above,
  // the list cannot be exactly reconstructed from sym alone.
  // This is a "short tag" system, not full bijective encoding.
  // You’d need a larger alphabet to perfectly reverse.

  return "(cannot recover exact list from short tag) length=" + length + " index=" + index;
}

// ---- UI glue ----
function doEncode() {
  let nums = document.getElementById("input").value.split(",").map(x => parseInt(x.trim()));
  let code = encodeList(nums);
  document.getElementById("compressed").innerText = code;
}
function doDecode() {
  let code = document.getElementById("compressed").innerText;
  let decoded = decodeList(code);
  document.getElementById("decoded").innerText = decoded;
}
</script>
</body>
</html>
